<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search and Filter Table in JS</title>
    <link rel="icon" href="icon.png" type="image/png">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .table_heading {
            width: 200px;
        }
    </style>
</head>

<body>
    <div class="main-container">
        <h1 class="text-lg md:text-3xl text-center text-red-400">Search and Filter Table with JS</h1>
        <div class="search-box text-center my-3">
            <input type="search" id="search-box" class="rounded-md outline-none border border-stone-400 w-1/3 px-5 py-1"
                placeholder="Search by Name">
        </div>
        <div class="table mx-auto my-5">
            <table class="table-auto text-center" style="width: 700px;">
                <thead>
                    <tr class="table_heading border border-stone-200 bg-lime-500 h-10">
                        <th class=" border-r border-stone-200">ID</th>
                        <th class=" border-r border-stone-200">Name</th>
                        <th class=" border-r border-stone-200">Gender</th>
                        <th class=" border-r border-stone-200">Age</th>
                        <th class=" ">Birthday</th>
                    </tr>
                </thead>
                <tbody id="table-body">
                    <!-- <tr class="h-8 bg-gray-200 odd:bg-white">
                        <td>1</td>
                        <td class="text-start">Maruf Hossain Rafsan (shihab)</td>
                        <td>M</td>
                        <td>16</td>
                        <td>13/10/2004</td>
                    </tr> -->
                </tbody>
            </table>
        </div>

    </div>

    <script>

        // Variable Initialization
        var tableData = [
            { "name": "Murad Hossain", "gender": "M", "age": 43, "birthDay": "20/07/1999" },
            { "name": "Maruf Hossain Rafsan", "gender": "M", "age": 16, "birthDay": "13/10/2004" },
            { "name": "Laila Begum", "gender": "F", "age": 33, "birthDay": "10/01/1800" },
            { "name": "Unknown", "gender": "O", "age": 24, "birthDay": "15/04/1889" },
            { "name": "Adu Vai", "gender": "M", "age": 24, "birthDay": "15/04/1889" },
            { "name": "ballo bHai", "gender": "O", "age": 24, "birthDay": "15/04/1889" },
            { "name": "hello world", "gender": "O", "age": 24, "birthDay": "15/04/1889" },
        ];

        let tableBody = document.getElementById('table-body');
        let searchBox = document.getElementById('search-box');
        let str = "";
        // Make functions
        const buildTable = (data) => {
            tableBody.innerHTML = "";
            for (let i = 0; i < data.length; i++) {
                const name = data[i].name;
                const gender = data[i].gender;
                const age = data[i].age;
                const birthDay = data[i].birthDay;
                let row = `
                    <tr class="h-8 bg-gray-200 odd:bg-white">
                        <td>${i + 1}</td>
                        <td class="td-name text-start" px-2>${name}</td>
                        <td class="td-gender">${gender}</td>
                        <td>${age}</td>
                        <td>${birthDay}</td>
                    </tr>
                `;
                tableBody.innerHTML = tableBody.innerHTML + row;
            }
        };

        buildTable(tableData);


        // Add event
        searchBox.addEventListener('keyup', () => {
            str = searchBox.value;
            search(str.toLowerCase())
            // // Not working
            // if(tableBody.innerHTML == ''){
            //     let h1Element = document.createElement("h1");
            //     let h1Text =document.createTextNode("Nothing is matched");
            //     h1Element.appendChild(h1Text);
            //     tableBody.appendChild(h1Element);
            // }
        });

        const search = (query) => {
            let tdNames = document.getElementsByClassName('td-name');
            let tdGenders = document.getElementsByClassName('td-gender');
            Array.from(tdNames).forEach((elm) => {
                elmText = elm.innerHTML;
                let tdName = elmText.toLowerCase();
                let elmParentRow = elm.parentElement;
                if (tdName.includes(query)) {
                    elmParentRow.style.display = '';
                }
                else {
                    elmParentRow.style.display = 'none';
                }
            });
        }
    </script>

</body>

</html>